<nz-table [nzShowPagination]='false' nzTemplateMode	[nzFooter]='tableFooter' nzSize='middle'>
	<thead>
	<tr>
		<th nzWidth='40px'></th>
		<th>Name</th>
		<th>Geburtstag</th>
		<th>Adresse</th>
		<th>Handynummer</th>
		<th>Verbleib</th>
	</tr>
	</thead>
	<tbody>
		@for (fg of formArray.controls; track $index) {
			<tr>
				<td
					[nzExpand]='expandSet.has($index)'
					[nzExpandIcon]='expandIcon'
				></td>
				<td>
					{{ fg.value.firstName }}
					{{ fg.value.lastName }}
				</td>
				<td>
					{{
						fg.value.birthDate
							? (fg.value.birthDate | date: 'dd.MM.yyyy')
							: ''
					}}
				</td>
				<td>
					@if (fg.value.address?.street && (fg.value.address?.postalCode || fg.value.address?.city)) {
						{{ fg.value.address!.street }},
						{{ fg.value.address!.postalCode }}
						{{ fg.value.address!.city }}
					} @else {
						{{ fg.value.address!.street }}
					}
				</td>
				<td>{{ fg.value.phoneNumber }}</td>
				<td>{{ fg.value.whereabouts }}</td>
			</tr>
			<tr [nzExpand]='expandSet.has($index)'>
				<krd-operation-patient-data-form [formGroup]='fg' size='small' />
				<div class='footer'>
					<button nz-button nzSize='small' (click)='removePatient($index)'>
						Löschen
					</button>
				</div>
			</tr>
			<ng-template #expandIcon>
				@if (expandSet.has($index)) {
					<span
						nz-icon
						nzType='minus-circle'
						nzTheme='outline'
						(click)='onExpandChange($index, false)'
					></span>
				} @else {
					<span
						nz-icon
						nzType='plus-circle'
						nzTheme='outline'
						(click)='onExpandChange($index, true)'
					></span>
				}
			</ng-template>
		} @empty {
			<tr>
				<td colspan='6' class='empty-result'>
					Keine Patientendaten hinzugefügt.
				</td>
			</tr>
		}
	</tbody>
</nz-table>

<ng-template #tableFooter>
<div class='footer'>
	<button nz-button (click)='addPatient()'>
		<span nz-icon nzType='plus' nzTheme='outline'></span> Neuen Patienten
		hinzufügen
	</button>
</div>
</ng-template>
